"use strict";(self.webpackChunkaastreli_frontend=self.webpackChunkaastreli_frontend||[]).push([[104],{536(e,t,a){a.d(t,{A:()=>C});var n=a(5043),r=a(35),l=a(6600),s=a(5316),o=a(8587),i=a(8168),c=a(8387),d=a(8610),u=a(4535),h=a(1475),m=a(8206),A=a(5865),p=a(2532),v=a(2372);function x(e){return(0,v.Ay)("MuiDialogContentText",e)}(0,p.A)("MuiDialogContentText",["root"]);var j=a(579);const g=["children","className"],f=(0,u.Ay)(A.A,{shouldForwardProp:e=>(0,h.A)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,t)=>t.root})({}),b=n.forwardRef(function(e,t){const a=(0,m.b)({props:e,name:"MuiDialogContentText"}),{className:n}=a,r=(0,o.A)(a,g),l=(e=>{const{classes:t}=e,a=(0,d.A)({root:["root"]},x,t);return(0,i.A)({},t,a)})(r);return(0,j.jsx)(f,(0,i.A)({component:"p",variant:"body1",color:"text.secondary",ref:t,ownerState:r,className:(0,c.A)(l.root,n)},a,{classes:l}))});var y=a(9347),w=a(1906);function C(e){let{open:t,title:a,message:n,confirmLabel:o="Confirm",cancelLabel:i="Cancel",onConfirm:c,onCancel:d}=e;return(0,j.jsxs)(r.A,{open:t,onClose:d,children:[(0,j.jsx)(l.A,{children:a}),(0,j.jsx)(s.A,{children:(0,j.jsx)(b,{children:n})}),(0,j.jsxs)(y.A,{children:[(0,j.jsx)(w.A,{onClick:d,children:i}),(0,j.jsx)(w.A,{onClick:c,variant:"contained",autoFocus:!0,children:o})]})]})}},3104(e,t,a){a.r(t),a.d(t,{default:()=>B});var n=a(2555),r=a(5043),l=a(9252),s=a(1637),o=a(6446),i=a(5865),c=a(1906),d=a(3193),u=a(9190),h=a(9285),m=a(2143),A=a(547),p=a(9650),v=a(3336),x=a(1806),j=a(4882),g=a(8076),f=a(39),b=a(3460),y=a(3845),w=a(8483),C=a(7392),_=a(35),k=a(6600),S=a(5316),z=a(5795),T=a(8577),M=a(4598),F=a(9347),R=a(2505),U=a(3159),D=a(3471),N=a(5054),W=a(536),E=a(6624),I=a(579);const P={email:"",username:"",password:"",full_name:"",role:"user",is_active:!0,tenant_id:""};function B(){const{tenantVersion:e,isSuperAdmin:t,tenants:a,tenantId:B}=(0,E.n8)(),[O,L]=(0,r.useState)([]),[q,V]=(0,r.useState)(!0),[X,H]=(0,r.useState)(null),[G,J]=(0,r.useState)(null),[$,K]=(0,r.useState)(!1),[Q,Y]=(0,r.useState)(!1),[Z,ee]=(0,r.useState)(P),[te,ae]=(0,r.useState)(null),[ne,re]=(0,r.useState)(null),[le,se]=(0,r.useState)(""),oe=async()=>{try{const e={};t&&le&&(e.tenant_id=le);const{data:a}=await N.Ay.get("/users",{params:e});L(Array.isArray(a)?a:[])}catch(e){console.error("Failed to load users:",e)}finally{V(!1)}};(0,r.useEffect)(()=>{oe()},[e,le]);const ie=t?["user","admin","super_admin"]:["user","admin"],ce=e=>{if(!e)return"\u2014";const t=a.find(t=>t.id===e);return t?t.tenant_name||t.tenant_code:e.slice(0,8)+"..."};return q?(0,I.jsx)(l.A,{maxWidth:"lg",sx:{mt:4,display:"flex",justifyContent:"center"},children:(0,I.jsx)(s.A,{})}):(0,I.jsxs)(l.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,I.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,I.jsx)(i.A,{variant:"h4",children:"Users"}),(0,I.jsx)(c.A,{variant:"contained",startIcon:(0,I.jsx)(R.A,{}),onClick:()=>{ae(null),ee((0,n.A)((0,n.A)({},P),{},{tenant_id:t&&le||""})),H(null),K(!0)},children:"Add User"})]}),t&&a.length>0&&(0,I.jsx)(o.A,{sx:{mb:2},children:(0,I.jsxs)(d.A,{size:"small",sx:{minWidth:250},children:[(0,I.jsx)(u.A,{children:"Filter by Tenant"}),(0,I.jsxs)(h.A,{value:le,label:"Filter by Tenant",onChange:e=>{se(e.target.value),V(!0)},children:[(0,I.jsx)(m.A,{value:"",children:"All Tenants"}),a.map(e=>(0,I.jsx)(m.A,{value:e.id,children:e.tenant_name||e.tenant_code},e.id))]})]})}),G&&(0,I.jsx)(A.A,{severity:"success",sx:{mb:2},onClose:()=>J(null),children:G}),X&&!$&&(0,I.jsx)(A.A,{severity:"error",sx:{mb:2},onClose:()=>H(null),children:X}),(0,I.jsx)(p.A,{component:v.A,children:(0,I.jsxs)(x.A,{children:[(0,I.jsx)(j.A,{children:(0,I.jsxs)(g.A,{children:[(0,I.jsx)(f.A,{children:(0,I.jsx)("strong",{children:"Username"})}),(0,I.jsx)(f.A,{children:(0,I.jsx)("strong",{children:"Email"})}),(0,I.jsx)(f.A,{children:(0,I.jsx)("strong",{children:"Full Name"})}),t&&(0,I.jsx)(f.A,{children:(0,I.jsx)("strong",{children:"Tenant"})}),(0,I.jsx)(f.A,{children:(0,I.jsx)("strong",{children:"Role"})}),(0,I.jsx)(f.A,{children:(0,I.jsx)("strong",{children:"Status"})}),(0,I.jsx)(f.A,{children:(0,I.jsx)("strong",{children:"Created"})}),(0,I.jsx)(f.A,{align:"right",children:(0,I.jsx)("strong",{children:"Actions"})})]})}),(0,I.jsx)(b.A,{children:0===O.length?(0,I.jsx)(g.A,{children:(0,I.jsx)(f.A,{colSpan:t?8:7,align:"center",children:(0,I.jsx)(i.A,{variant:"body2",color:"text.secondary",sx:{py:4},children:'No users found. Click "Add User" to create one.'})})}):O.map(e=>(0,I.jsxs)(g.A,{hover:!0,children:[(0,I.jsx)(f.A,{children:(0,I.jsx)(i.A,{variant:"body2",sx:{fontFamily:"monospace",fontWeight:600},children:e.username})}),(0,I.jsx)(f.A,{children:e.email||"\u2014"}),(0,I.jsx)(f.A,{children:e.full_name||"\u2014"}),t&&(0,I.jsx)(f.A,{children:(0,I.jsx)(i.A,{variant:"body2",color:"text.secondary",children:ce(e.tenant_id)})}),(0,I.jsx)(f.A,{children:(0,I.jsx)(y.A,{label:e.role,size:"small",color:"super_admin"===e.role?"warning":"admin"===e.role?"primary":"default",variant:"outlined"})}),(0,I.jsx)(f.A,{children:(0,I.jsx)(y.A,{label:e.is_active?"Active":"Inactive",size:"small",color:e.is_active?"success":"default",onClick:()=>(async e=>{try{await N.Ay.patch("/users/".concat(e.id),{is_active:!e.is_active}),J('User "'.concat(e.username,'" ').concat(e.is_active?"deactivated":"activated"," successfully")),setTimeout(()=>J(null),4e3),await oe()}catch(n){var t,a;H((null===(t=n.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||"Failed to update user")}})(e),sx:{cursor:"pointer"}})}),(0,I.jsx)(f.A,{children:e.created_at?new Date(e.created_at).toLocaleDateString():"\u2014"}),(0,I.jsxs)(f.A,{align:"right",children:[(0,I.jsx)(w.A,{title:"Edit",children:(0,I.jsx)(C.A,{size:"small",onClick:()=>(e=>{ae(e.id),ee({email:e.email||"",username:e.username,password:"",full_name:e.full_name||"",role:e.role,is_active:e.is_active,tenant_id:e.tenant_id||""}),H(null),K(!0)})(e),children:(0,I.jsx)(U.A,{fontSize:"small"})})}),(0,I.jsx)(w.A,{title:"Delete",children:(0,I.jsx)(C.A,{size:"small",color:"error",onClick:()=>re(e),children:(0,I.jsx)(D.A,{fontSize:"small"})})})]})]},e.id))})]})}),(0,I.jsxs)(_.A,{open:$,onClose:()=>K(!1),maxWidth:"sm",fullWidth:!0,children:[(0,I.jsx)(k.A,{children:te?"Edit User":"Create User"}),(0,I.jsxs)(S.A,{children:[X&&$&&(0,I.jsx)(A.A,{severity:"error",sx:{mb:2,mt:1},onClose:()=>H(null),children:X}),!te&&(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(z.A,{fullWidth:!0,required:!0,label:"Email",type:"email",value:Z.email,onChange:e=>ee((0,n.A)((0,n.A)({},Z),{},{email:e.target.value})),sx:{mt:2,mb:2},placeholder:"e.g. user@example.com"}),(0,I.jsx)(z.A,{fullWidth:!0,required:!0,label:"Username",value:Z.username,onChange:e=>ee((0,n.A)((0,n.A)({},Z),{},{username:e.target.value})),sx:{mb:2},placeholder:"e.g. jsmith"}),(0,I.jsx)(z.A,{fullWidth:!0,required:!0,label:"Password",type:"password",value:Z.password,onChange:e=>ee((0,n.A)((0,n.A)({},Z),{},{password:e.target.value})),sx:{mb:2}})]}),(0,I.jsx)(z.A,{fullWidth:!0,label:"Full Name",value:Z.full_name,onChange:e=>ee((0,n.A)((0,n.A)({},Z),{},{full_name:e.target.value})),sx:{mt:te?2:0,mb:2},placeholder:"e.g. John Smith"}),t&&!te&&a.length>0&&(0,I.jsxs)(d.A,{fullWidth:!0,sx:{mb:2},children:[(0,I.jsx)(u.A,{children:"Tenant"}),(0,I.jsxs)(h.A,{value:Z.tenant_id,label:"Tenant",onChange:e=>ee((0,n.A)((0,n.A)({},Z),{},{tenant_id:e.target.value})),children:[(0,I.jsx)(m.A,{value:"",children:(0,I.jsx)("em",{children:"None (platform-level)"})}),a.map(e=>(0,I.jsx)(m.A,{value:e.id,children:e.tenant_name||e.tenant_code},e.id))]})]}),(0,I.jsxs)(d.A,{fullWidth:!0,sx:{mb:2},children:[(0,I.jsx)(u.A,{children:"Role"}),(0,I.jsx)(h.A,{value:Z.role,label:"Role",onChange:e=>ee((0,n.A)((0,n.A)({},Z),{},{role:e.target.value})),children:ie.map(e=>(0,I.jsx)(m.A,{value:e,children:"super_admin"===e?"Super Admin":e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),te&&(0,I.jsx)(T.A,{control:(0,I.jsx)(M.A,{checked:Z.is_active,onChange:e=>ee((0,n.A)((0,n.A)({},Z),{},{is_active:e.target.checked}))}),label:"Active"})]}),(0,I.jsxs)(F.A,{sx:{px:3,pb:2},children:[(0,I.jsx)(c.A,{onClick:()=>{K(!1),H(null)},children:"Cancel"}),(0,I.jsx)(c.A,{variant:"contained",onClick:async()=>{if(te){Y(!0),H(null);try{const e={};Z.full_name&&(e.full_name=Z.full_name),e.role=Z.role,e.is_active=Z.is_active,await N.Ay.patch("/users/".concat(te),e),J('User "'.concat(Z.username,'" updated successfully')),setTimeout(()=>J(null),4e3),K(!1),ee(P),ae(null),await oe()}catch(l){var e,a;H((null===(e=l.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||"Failed to update user")}finally{Y(!1)}}else{if(!Z.email||!Z.username||!Z.password)return void H("Email, Username, and Password are required");Y(!0),H(null);try{const e={email:Z.email,username:Z.username,password:Z.password,role:Z.role};Z.full_name&&(e.full_name=Z.full_name),t&&Z.tenant_id&&(e.tenant_id=Z.tenant_id),await N.Ay.post("/users",e),J('User "'.concat(Z.username,'" created successfully')),setTimeout(()=>J(null),4e3),K(!1),ee(P),await oe()}catch(l){var n,r;H((null===(n=l.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.detail)||"Failed to create user")}finally{Y(!1)}}},disabled:Q||!te&&(!Z.email||!Z.username||!Z.password),children:Q?"Saving...":te?"Update User":"Create User"})]})]}),(0,I.jsx)(W.A,{open:!!ne,title:"Delete User",message:'Are you sure you want to delete user "'.concat(null===ne||void 0===ne?void 0:ne.username,'"? This action cannot be undone.'),confirmLabel:"Delete",onConfirm:async()=>{if(ne)try{await N.Ay.delete("/users/".concat(ne.id)),J('User "'.concat(ne.username,'" deleted successfully')),setTimeout(()=>J(null),4e3),re(null),await oe()}catch(a){var e,t;H((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to delete user"),re(null)}},onCancel:()=>re(null)})]})}},2505(e,t,a){var n=a(4994);t.A=void 0;var r=n(a(2420)),l=a(579);t.A=(0,r.default)((0,l.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},3471(e,t,a){var n=a(4994);t.A=void 0;var r=n(a(2420)),l=a(579);t.A=(0,r.default)((0,l.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},3159(e,t,a){var n=a(4994);t.A=void 0;var r=n(a(2420)),l=a(579);t.A=(0,r.default)((0,l.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},2420(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=a(4421)},4598(e,t,a){a.d(t,{A:()=>w});var n=a(8587),r=a(8168),l=a(5043),s=a(8387),o=a(8610),i=a(7266),c=a(6803),d=a(3064),u=a(4535),h=a(8206),m=a(2532),A=a(2372);function p(e){return(0,A.Ay)("MuiSwitch",e)}const v=(0,m.A)("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]);var x=a(579);const j=["className","color","edge","size","sx"],g=(0,u.Ay)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.edge&&t["edge".concat((0,c.A)(a.edge))],t["size".concat((0,c.A)(a.size))]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,["& .".concat(v.thumb)]:{width:16,height:16},["& .".concat(v.switchBase)]:{padding:4,["&.".concat(v.checked)]:{transform:"translateX(16px)"}}}}]}),f=(0,u.Ay)(d.A,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.switchBase,{["& .".concat(v.input)]:t.input},"default"!==a.color&&t["color".concat((0,c.A)(a.color))]]}})(e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:"".concat("light"===t.palette.mode?t.palette.common.white:t.palette.grey[300]),transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),["&.".concat(v.checked)]:{transform:"translateX(20px)"},["&.".concat(v.disabled)]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:"".concat("light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600])},["&.".concat(v.checked," + .").concat(v.track)]:{opacity:.5},["&.".concat(v.disabled," + .").concat(v.track)]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:"".concat("light"===t.palette.mode?.12:.2)},["& .".concat(v.input)]:{left:"-100%",width:"300%"}}},e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,i.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(e=>{let[,t]=e;return t.main&&t.light}).map(e=>{let[a]=e;return{props:{color:a},style:{["&.".concat(v.checked)]:{color:(t.vars||t).palette[a].main,"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[a].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,i.X4)(t.palette[a].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(v.disabled)]:{color:t.vars?t.vars.palette.Switch["".concat(a,"DisabledColor")]:"".concat("light"===t.palette.mode?(0,i.a)(t.palette[a].main,.62):(0,i.e$)(t.palette[a].main,.55))}},["&.".concat(v.checked," + .").concat(v.track)]:{backgroundColor:(t.vars||t).palette[a].main}}}})]}}),b=(0,u.Ay)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(e=>{let{theme:t}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:"".concat("light"===t.palette.mode?t.palette.common.black:t.palette.common.white),opacity:t.vars?t.vars.opacity.switchTrack:"".concat("light"===t.palette.mode?.38:.3)}}),y=(0,u.Ay)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(e=>{let{theme:t}=e;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}}),w=l.forwardRef(function(e,t){const a=(0,h.b)({props:e,name:"MuiSwitch"}),{className:l,color:i="primary",edge:d=!1,size:u="medium",sx:m}=a,A=(0,n.A)(a,j),v=(0,r.A)({},a,{color:i,edge:d,size:u}),w=(e=>{const{classes:t,edge:a,size:n,color:l,checked:s,disabled:i}=e,d={root:["root",a&&"edge".concat((0,c.A)(a)),"size".concat((0,c.A)(n))],switchBase:["switchBase","color".concat((0,c.A)(l)),s&&"checked",i&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},u=(0,o.A)(d,p,t);return(0,r.A)({},t,u)})(v),C=(0,x.jsx)(y,{className:w.thumb,ownerState:v});return(0,x.jsxs)(g,{className:(0,s.A)(w.root,l),sx:m,ownerState:v,children:[(0,x.jsx)(f,(0,r.A)({type:"checkbox",icon:C,checkedIcon:C,ref:t,ownerState:v},A,{classes:(0,r.A)({},w,{root:w.switchBase})})),(0,x.jsx)(b,{className:w.track,ownerState:v})]})})},4421(e,t,a){a.r(t),a.d(t,{capitalize:()=>r.A,createChainedFunction:()=>l,createSvgIcon:()=>s.A,debounce:()=>o.A,deprecatedPropType:()=>i,isMuiElement:()=>c.A,ownerDocument:()=>d.A,ownerWindow:()=>u.A,requirePropFactory:()=>h,setRef:()=>m,unstable_ClassNameGenerator:()=>b,unstable_useEnhancedEffect:()=>A.A,unstable_useId:()=>p.A,unsupportedProp:()=>v,useControlled:()=>x.A,useEventCallback:()=>j.A,useForkRef:()=>g.A,useIsFocusVisible:()=>f.A});var n=a(9386),r=a(6803);const l=a(2456).A;var s=a(9662),o=a(950);const i=function(e,t){return()=>null};var c=a(7328),d=a(2427),u=a(6078);const h=function(e,t){return()=>null};const m=a(6564).A;var A=a(5013),p=a(5879);const v=function(e,t,a,n,r){return null};var x=a(4516),j=a(3319),g=a(5849),f=a(3574);const b={configure:e=>{n.A.configure(e)}}}}]);
//# sourceMappingURL=104.8b83f12b.chunk.js.map