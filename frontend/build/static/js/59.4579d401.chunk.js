"use strict";(self.webpackChunkaastreli_frontend=self.webpackChunkaastreli_frontend||[]).push([[59],{536(e,a,t){t.d(a,{A:()=>C});var s=t(5043),n=t(35),r=t(6600),l=t(5316),i=t(8587),o=t(8168),d=t(8387),c=t(8610),u=t(4535),A=t(1475),h=t(8206),x=t(5865),y=t(2532),v=t(2372);function j(e){return(0,v.Ay)("MuiDialogContentText",e)}(0,y.A)("MuiDialogContentText",["root"]);var f=t(579);const g=["children","className"],w=(0,u.Ay)(x.A,{shouldForwardProp:e=>(0,A.A)(e)||"classes"===e,name:"MuiDialogContentText",slot:"Root",overridesResolver:(e,a)=>a.root})({}),m=s.forwardRef(function(e,a){const t=(0,h.b)({props:e,name:"MuiDialogContentText"}),{className:s}=t,n=(0,i.A)(t,g),r=(e=>{const{classes:a}=e,t=(0,c.A)({root:["root"]},j,a);return(0,o.A)({},a,t)})(n);return(0,f.jsx)(w,(0,o.A)({component:"p",variant:"body1",color:"text.secondary",ref:a,ownerState:n,className:(0,d.A)(r.root,s)},t,{classes:r}))});var p=t(9347),_=t(1906);function C(e){let{open:a,title:t,message:s,confirmLabel:i="Confirm",cancelLabel:o="Cancel",onConfirm:d,onCancel:c}=e;return(0,f.jsxs)(n.A,{open:a,onClose:c,children:[(0,f.jsx)(r.A,{children:t}),(0,f.jsx)(l.A,{children:(0,f.jsx)(m,{children:s})}),(0,f.jsxs)(p.A,{children:[(0,f.jsx)(_.A,{onClick:c,children:o}),(0,f.jsx)(_.A,{onClick:d,variant:"contained",autoFocus:!0,children:i})]})]})}},9059(e,a,t){t.r(a),t.d(a,{default:()=>T});var s=t(2555),n=t(5043),r=t(9252),l=t(1637),i=t(6446),o=t(5865),d=t(1906),c=t(547),u=t(9650),A=t(3336),h=t(1806),x=t(4882),y=t(8076),v=t(39),j=t(3460),f=t(8483),g=t(7392),w=t(35),m=t(6600),p=t(5316),_=t(5795),C=t(3193),b=t(9190),S=t(9285),G=t(2143),k=t(9347),F=t(2505),M=t(3159),W=t(3471),z=t(5054),D=t(536),E=t(6624),I=t(579);const P={gateway_code:"",site_id:"",ip_address:"",firmware_version:""};function T(){const{tenantVersion:e}=(0,E.n8)(),[a,t]=(0,n.useState)([]),[T,V]=(0,n.useState)([]),[N,R]=(0,n.useState)(!0),[q,L]=(0,n.useState)(null),[H,O]=(0,n.useState)(null),[U,B]=(0,n.useState)(!1),[J,K]=(0,n.useState)(!1),[Q,X]=(0,n.useState)(P),[Y,Z]=(0,n.useState)(null),[$,ee]=(0,n.useState)(null),ae=async()=>{try{const{data:e}=await z.Ay.get("/gateways");t(Array.isArray(e)?e:e.gateways||[])}catch(e){console.error("Failed to load gateways:",e)}finally{R(!1)}};(0,n.useEffect)(()=>{(async()=>{try{const{data:e}=await z.Ay.get("/sites");V(Array.isArray(e)?e:e.sites||[])}catch(e){console.error("Failed to load sites:",e)}})(),ae()},[e]);const te=e=>{const a=T.find(a=>a.id===e);return a?"".concat(a.site_name," (").concat(a.site_code,")"):e};return N?(0,I.jsx)(r.A,{maxWidth:"lg",sx:{mt:4,display:"flex",justifyContent:"center"},children:(0,I.jsx)(l.A,{})}):(0,I.jsxs)(r.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,I.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,I.jsx)(o.A,{variant:"h4",children:"Gateways"}),(0,I.jsx)(d.A,{variant:"contained",startIcon:(0,I.jsx)(F.A,{}),onClick:()=>{Z(null),X(P),L(null),B(!0)},children:"Add Gateway"})]}),H&&(0,I.jsx)(c.A,{severity:"success",sx:{mb:2},onClose:()=>O(null),children:H}),q&&!U&&(0,I.jsx)(c.A,{severity:"error",sx:{mb:2},onClose:()=>L(null),children:q}),(0,I.jsx)(u.A,{component:A.A,children:(0,I.jsxs)(h.A,{children:[(0,I.jsx)(x.A,{children:(0,I.jsxs)(y.A,{children:[(0,I.jsx)(v.A,{children:(0,I.jsx)("strong",{children:"Gateway Code"})}),(0,I.jsx)(v.A,{children:(0,I.jsx)("strong",{children:"Site"})}),(0,I.jsx)(v.A,{children:(0,I.jsx)("strong",{children:"IP Address"})}),(0,I.jsx)(v.A,{children:(0,I.jsx)("strong",{children:"Firmware"})}),(0,I.jsx)(v.A,{align:"right",children:(0,I.jsx)("strong",{children:"Actions"})})]})}),(0,I.jsx)(j.A,{children:0===a.length?(0,I.jsx)(y.A,{children:(0,I.jsx)(v.A,{colSpan:5,align:"center",children:(0,I.jsx)(o.A,{variant:"body2",color:"text.secondary",sx:{py:4},children:'No gateways configured. Click "Add Gateway" to get started.'})})}):a.map(e=>(0,I.jsxs)(y.A,{hover:!0,children:[(0,I.jsx)(v.A,{children:(0,I.jsx)(o.A,{variant:"body2",sx:{fontFamily:"monospace",fontWeight:600},children:e.gateway_code})}),(0,I.jsx)(v.A,{children:te(e.site_id)}),(0,I.jsx)(v.A,{children:e.ip_address||"\u2014"}),(0,I.jsx)(v.A,{children:e.firmware_version||"\u2014"}),(0,I.jsxs)(v.A,{align:"right",children:[(0,I.jsx)(f.A,{title:"Edit",children:(0,I.jsx)(g.A,{size:"small",onClick:()=>(e=>{Z(e.id),X({gateway_code:e.gateway_code,site_id:e.site_id,ip_address:e.ip_address||"",firmware_version:e.firmware_version||""}),L(null),B(!0)})(e),children:(0,I.jsx)(M.A,{fontSize:"small"})})}),(0,I.jsx)(f.A,{title:"Delete",children:(0,I.jsx)(g.A,{size:"small",color:"error",onClick:()=>ee(e),children:(0,I.jsx)(W.A,{fontSize:"small"})})})]})]},e.id))})]})}),(0,I.jsxs)(w.A,{open:U,onClose:()=>B(!1),maxWidth:"sm",fullWidth:!0,children:[(0,I.jsx)(m.A,{children:Y?"Edit Gateway":"Create Gateway"}),(0,I.jsxs)(p.A,{children:[q&&U&&(0,I.jsx)(c.A,{severity:"error",sx:{mb:2,mt:1},onClose:()=>L(null),children:q}),(0,I.jsx)(_.A,{fullWidth:!0,required:!0,label:"Gateway Code",value:Q.gateway_code,onChange:e=>X((0,s.A)((0,s.A)({},Q),{},{gateway_code:e.target.value})),sx:{mt:2,mb:2},placeholder:"e.g. GW-001"}),(0,I.jsxs)(C.A,{fullWidth:!0,required:!0,sx:{mb:2},children:[(0,I.jsx)(b.A,{children:"Site"}),(0,I.jsx)(S.A,{value:Q.site_id,label:"Site",onChange:e=>X((0,s.A)((0,s.A)({},Q),{},{site_id:e.target.value})),children:T.map(e=>(0,I.jsxs)(G.A,{value:e.id,children:[e.site_name," (",e.site_code,")"]},e.id))})]}),(0,I.jsx)(_.A,{fullWidth:!0,label:"IP Address",value:Q.ip_address,onChange:e=>X((0,s.A)((0,s.A)({},Q),{},{ip_address:e.target.value})),sx:{mb:2},placeholder:"e.g. 192.168.1.100"}),(0,I.jsx)(_.A,{fullWidth:!0,label:"Firmware Version",value:Q.firmware_version,onChange:e=>X((0,s.A)((0,s.A)({},Q),{},{firmware_version:e.target.value})),placeholder:"e.g. v2.1.0"})]}),(0,I.jsxs)(k.A,{sx:{px:3,pb:2},children:[(0,I.jsx)(d.A,{onClick:()=>{B(!1),L(null)},children:"Cancel"}),(0,I.jsx)(d.A,{variant:"contained",onClick:async()=>{if(Q.gateway_code&&Q.site_id){K(!0),L(null);try{const e={gateway_code:Q.gateway_code,site_id:Q.site_id};Q.ip_address&&(e.ip_address=Q.ip_address),Q.firmware_version&&(e.firmware_version=Q.firmware_version),Y?(await z.Ay.patch("/gateways/".concat(Y),e),O('Gateway "'.concat(Q.gateway_code,'" updated successfully'))):(await z.Ay.post("/gateways",e),O('Gateway "'.concat(Q.gateway_code,'" created successfully'))),setTimeout(()=>O(null),4e3),B(!1),X(P),Z(null),await ae()}catch(t){var e,a;L((null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||"Failed to save gateway")}finally{K(!1)}}else L("Gateway Code and Site are required")},disabled:J||!Q.gateway_code||!Q.site_id,children:J?"Saving...":Y?"Update Gateway":"Create Gateway"})]})]}),(0,I.jsx)(D.A,{open:!!$,title:"Delete Gateway",message:'Are you sure you want to delete gateway "'.concat(null===$||void 0===$?void 0:$.gateway_code,'"? This action cannot be undone.'),confirmLabel:"Delete",onConfirm:async()=>{if($)try{await z.Ay.delete("/gateways/".concat($.id)),O('Gateway "'.concat($.gateway_code,'" deleted successfully')),setTimeout(()=>O(null),4e3),ee(null),await ae()}catch(t){var e,a;L((null===(e=t.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||"Failed to delete gateway"),ee(null)}},onCancel:()=>ee(null)})]})}},2505(e,a,t){var s=t(4994);a.A=void 0;var n=s(t(2420)),r=t(579);a.A=(0,n.default)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},3471(e,a,t){var s=t(4994);a.A=void 0;var n=s(t(2420)),r=t(579);a.A=(0,n.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},3159(e,a,t){var s=t(4994);a.A=void 0;var n=s(t(2420)),r=t(579);a.A=(0,n.default)((0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},2420(e,a,t){Object.defineProperty(a,"__esModule",{value:!0}),Object.defineProperty(a,"default",{enumerable:!0,get:function(){return s.createSvgIcon}});var s=t(4421)},4421(e,a,t){t.r(a),t.d(a,{capitalize:()=>n.A,createChainedFunction:()=>r,createSvgIcon:()=>l.A,debounce:()=>i.A,deprecatedPropType:()=>o,isMuiElement:()=>d.A,ownerDocument:()=>c.A,ownerWindow:()=>u.A,requirePropFactory:()=>A,setRef:()=>h,unstable_ClassNameGenerator:()=>m,unstable_useEnhancedEffect:()=>x.A,unstable_useId:()=>y.A,unsupportedProp:()=>v,useControlled:()=>j.A,useEventCallback:()=>f.A,useForkRef:()=>g.A,useIsFocusVisible:()=>w.A});var s=t(9386),n=t(6803);const r=t(2456).A;var l=t(9662),i=t(950);const o=function(e,a){return()=>null};var d=t(7328),c=t(2427),u=t(6078);const A=function(e,a){return()=>null};const h=t(6564).A;var x=t(5013),y=t(5879);const v=function(e,a,t,s,n){return null};var j=t(4516),f=t(3319),g=t(5849),w=t(3574);const m={configure:e=>{s.A.configure(e)}}}}]);
//# sourceMappingURL=59.4579d401.chunk.js.map