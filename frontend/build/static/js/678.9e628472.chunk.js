"use strict";(self.webpackChunkaastreli_frontend=self.webpackChunkaastreli_frontend||[]).push([[678],{7678(e,t,a){a.r(t),a.d(t,{default:()=>O});var n=a(2555),l=a(5043),r=a(9252),o=a(1637),i=a(6446),s=a(5865),c=a(1906),d=a(547),u=a(9650),h=a(3336),v=a(1806),A=a(4882),p=a(8076),m=a(39),x=a(3460),g=a(3845),y=a(7392),j=a(35),f=a(6600),b=a(5316),w=a(5795),C=a(3193),k=a(9190),S=a(9285),_=a(2143),z=a(8577),R=a(4598),M=a(9347),T=a(2505),I=a(3159),W=a(3471),N=a(5054),D=a(6624),E=a(579);const F={rule_name:"",condition_type:"threshold",condition_value:"",severity:"warning",is_active:!0},B={critical:"error",warning:"warning",info:"info"};function O(){const{tenantVersion:e}=(0,D.n8)(),[t,a]=(0,l.useState)([]),[O,V]=(0,l.useState)(!0),[P,q]=(0,l.useState)(null),[H,X]=(0,l.useState)(null),[L,G]=(0,l.useState)(!1),[U,$]=(0,l.useState)(!1),[J,K]=(0,l.useState)(F),[Q,Y]=(0,l.useState)(null),[Z,ee]=(0,l.useState)(!1),[te,ae]=(0,l.useState)(null),ne=async()=>{try{const{data:e}=await N.Ay.get("/alerts/rules");a(Array.isArray(e)?e:e.rules||[])}catch(n){var e,t;q((null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to load alarm rules")}finally{V(!1)}};(0,l.useEffect)(()=>{ne()},[e]);const le=e=>"".concat({threshold:"Threshold",anomaly_score:"Anomaly Score",fault_class:"Fault Class"}[e.condition_type]||e.condition_type,": ").concat(e.condition_value);return O?(0,E.jsx)(r.A,{maxWidth:"lg",sx:{mt:4,display:"flex",justifyContent:"center"},children:(0,E.jsx)(o.A,{})}):(0,E.jsxs)(r.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,E.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,E.jsx)(s.A,{variant:"h4",children:"Alarm Rules"}),(0,E.jsx)(c.A,{variant:"contained",startIcon:(0,E.jsx)(T.A,{}),onClick:()=>{K(F),Y(null),q(null),G(!0)},children:"Create Rule"})]}),H&&(0,E.jsx)(d.A,{severity:"success",sx:{mb:2},onClose:()=>X(null),children:H}),P&&!L&&(0,E.jsx)(d.A,{severity:"error",sx:{mb:2},onClose:()=>q(null),children:P}),(0,E.jsx)(u.A,{component:h.A,children:(0,E.jsxs)(v.A,{children:[(0,E.jsx)(A.A,{children:(0,E.jsxs)(p.A,{children:[(0,E.jsx)(m.A,{children:(0,E.jsx)("strong",{children:"Rule Name"})}),(0,E.jsx)(m.A,{children:(0,E.jsx)("strong",{children:"Condition"})}),(0,E.jsx)(m.A,{children:(0,E.jsx)("strong",{children:"Severity"})}),(0,E.jsx)(m.A,{children:(0,E.jsx)("strong",{children:"Status"})}),(0,E.jsx)(m.A,{children:(0,E.jsx)("strong",{children:"Actions"})})]})}),(0,E.jsx)(x.A,{children:0===t.length?(0,E.jsx)(p.A,{children:(0,E.jsx)(m.A,{colSpan:5,align:"center",children:(0,E.jsx)(s.A,{variant:"body2",color:"text.secondary",sx:{py:4},children:'No alarm rules configured. Click "Create Rule" to get started.'})})}):t.map(e=>(0,E.jsxs)(p.A,{hover:!0,children:[(0,E.jsx)(m.A,{children:e.rule_name}),(0,E.jsx)(m.A,{children:le(e)}),(0,E.jsx)(m.A,{children:(0,E.jsx)(g.A,{label:e.severity,size:"small",color:B[e.severity]||"default"})}),(0,E.jsx)(m.A,{children:(0,E.jsx)(g.A,{label:e.is_active?"Active":"Inactive",size:"small",color:e.is_active?"success":"default",variant:e.is_active?"filled":"outlined"})}),(0,E.jsxs)(m.A,{children:[(0,E.jsx)(y.A,{size:"small",onClick:()=>(e=>{K({rule_name:e.rule_name,condition_type:e.condition_type,condition_value:e.condition_value,severity:e.severity,is_active:e.is_active}),Y(e.id),q(null),G(!0)})(e),title:"Edit",children:(0,E.jsx)(I.A,{fontSize:"small"})}),(0,E.jsx)(y.A,{size:"small",onClick:()=>{return t=e.id,ae(t),void ee(!0);var t},title:"Delete",color:"error",children:(0,E.jsx)(W.A,{fontSize:"small"})})]})]},e.id))})]})}),(0,E.jsxs)(j.A,{open:L,onClose:()=>G(!1),maxWidth:"sm",fullWidth:!0,children:[(0,E.jsx)(f.A,{children:Q?"Edit Rule":"Create Alarm Rule"}),(0,E.jsxs)(b.A,{children:[P&&L&&(0,E.jsx)(d.A,{severity:"error",sx:{mb:2,mt:1},onClose:()=>q(null),children:P}),(0,E.jsx)(w.A,{fullWidth:!0,required:!0,label:"Rule Name",value:J.rule_name,onChange:e=>K((0,n.A)((0,n.A)({},J),{},{rule_name:e.target.value})),sx:{mt:2,mb:2},placeholder:"e.g. High Temperature Alert"}),(0,E.jsxs)(C.A,{fullWidth:!0,sx:{mb:2},children:[(0,E.jsx)(k.A,{children:"Condition Type"}),(0,E.jsxs)(S.A,{value:J.condition_type,label:"Condition Type",onChange:e=>K((0,n.A)((0,n.A)({},J),{},{condition_type:e.target.value})),children:[(0,E.jsx)(_.A,{value:"threshold",children:"Threshold"}),(0,E.jsx)(_.A,{value:"anomaly_score",children:"Anomaly Score"}),(0,E.jsx)(_.A,{value:"fault_class",children:"Fault Class"})]})]}),(0,E.jsx)(w.A,{fullWidth:!0,required:!0,label:"Condition Value",value:J.condition_value,onChange:e=>K((0,n.A)((0,n.A)({},J),{},{condition_value:e.target.value})),sx:{mb:2},placeholder:"e.g. > 85.0",helperText:"The threshold value or pattern to match"}),(0,E.jsxs)(C.A,{fullWidth:!0,sx:{mb:2},children:[(0,E.jsx)(k.A,{children:"Severity"}),(0,E.jsxs)(S.A,{value:J.severity,label:"Severity",onChange:e=>K((0,n.A)((0,n.A)({},J),{},{severity:e.target.value})),children:[(0,E.jsx)(_.A,{value:"critical",children:"Critical"}),(0,E.jsx)(_.A,{value:"warning",children:"Warning"}),(0,E.jsx)(_.A,{value:"info",children:"Info"})]})]}),(0,E.jsx)(z.A,{control:(0,E.jsx)(R.A,{checked:J.is_active,onChange:e=>K((0,n.A)((0,n.A)({},J),{},{is_active:e.target.checked}))}),label:"Active"})]}),(0,E.jsxs)(M.A,{sx:{px:3,pb:2},children:[(0,E.jsx)(c.A,{onClick:()=>{G(!1),q(null)},children:"Cancel"}),(0,E.jsx)(c.A,{variant:"contained",onClick:async()=>{if(J.rule_name&&J.condition_value){$(!0),q(null);try{Q?(await N.Ay.patch("/alerts/rules/".concat(Q),J),X('Rule "'.concat(J.rule_name,'" updated successfully'))):(await N.Ay.post("/alerts/rules",J),X('Rule "'.concat(J.rule_name,'" created successfully'))),setTimeout(()=>X(null),4e3),G(!1),K(F),Y(null),await ne()}catch(a){var e,t;q((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to save rule")}finally{$(!1)}}else q("Rule Name and Condition Value are required")},disabled:U||!J.rule_name||!J.condition_value,children:U?"Saving...":Q?"Update Rule":"Create Rule"})]})]}),(0,E.jsxs)(j.A,{open:Z,onClose:()=>ee(!1),maxWidth:"xs",fullWidth:!0,children:[(0,E.jsx)(f.A,{children:"Delete Rule"}),(0,E.jsx)(b.A,{children:(0,E.jsx)(s.A,{children:"Are you sure you want to delete this alarm rule? This action cannot be undone."})}),(0,E.jsxs)(M.A,{sx:{px:3,pb:2},children:[(0,E.jsx)(c.A,{onClick:()=>ee(!1),children:"Cancel"}),(0,E.jsx)(c.A,{variant:"contained",color:"error",onClick:async()=>{if(te){$(!0);try{await N.Ay.delete("/alerts/rules/".concat(te)),X("Rule deleted successfully"),setTimeout(()=>X(null),4e3),ee(!1),ae(null),await ne()}catch(a){var e,t;q((null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Failed to delete rule"),ee(!1)}finally{$(!1)}}},disabled:U,children:U?"Deleting...":"Delete"})]})]})]})}},2505(e,t,a){var n=a(4994);t.A=void 0;var l=n(a(2420)),r=a(579);t.A=(0,l.default)((0,r.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},3471(e,t,a){var n=a(4994);t.A=void 0;var l=n(a(2420)),r=a(579);t.A=(0,l.default)((0,r.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zM19 4h-3.5l-1-1h-5l-1 1H5v2h14z"}),"Delete")},3159(e,t,a){var n=a(4994);t.A=void 0;var l=n(a(2420)),r=a(579);t.A=(0,l.default)((0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},2420(e,t,a){Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n.createSvgIcon}});var n=a(4421)},4598(e,t,a){a.d(t,{A:()=>w});var n=a(8587),l=a(8168),r=a(5043),o=a(8387),i=a(8610),s=a(7266),c=a(6803),d=a(3064),u=a(4535),h=a(8206),v=a(2532),A=a(2372);function p(e){return(0,A.Ay)("MuiSwitch",e)}const m=(0,v.A)("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]);var x=a(579);const g=["className","color","edge","size","sx"],y=(0,u.Ay)("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.edge&&t["edge".concat((0,c.A)(a.edge))],t["size".concat((0,c.A)(a.size))]]}})({display:"inline-flex",width:58,height:38,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,["& .".concat(m.thumb)]:{width:16,height:16},["& .".concat(m.switchBase)]:{padding:4,["&.".concat(m.checked)]:{transform:"translateX(16px)"}}}}]}),j=(0,u.Ay)(d.A,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.switchBase,{["& .".concat(m.input)]:t.input},"default"!==a.color&&t["color".concat((0,c.A)(a.color))]]}})(e=>{let{theme:t}=e;return{position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:"".concat("light"===t.palette.mode?t.palette.common.white:t.palette.grey[300]),transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),["&.".concat(m.checked)]:{transform:"translateX(20px)"},["&.".concat(m.disabled)]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:"".concat("light"===t.palette.mode?t.palette.grey[100]:t.palette.grey[600])},["&.".concat(m.checked," + .").concat(m.track)]:{opacity:.5},["&.".concat(m.disabled," + .").concat(m.track)]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:"".concat("light"===t.palette.mode?.12:.2)},["& .".concat(m.input)]:{left:"-100%",width:"300%"}}},e=>{let{theme:t}=e;return{"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette.action.activeChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,s.X4)(t.palette.action.active,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(e=>{let[,t]=e;return t.main&&t.light}).map(e=>{let[a]=e;return{props:{color:a},style:{["&.".concat(m.checked)]:{color:(t.vars||t).palette[a].main,"&:hover":{backgroundColor:t.vars?"rgba(".concat(t.vars.palette[a].mainChannel," / ").concat(t.vars.palette.action.hoverOpacity,")"):(0,s.X4)(t.palette[a].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},["&.".concat(m.disabled)]:{color:t.vars?t.vars.palette.Switch["".concat(a,"DisabledColor")]:"".concat("light"===t.palette.mode?(0,s.a)(t.palette[a].main,.62):(0,s.e$)(t.palette[a].main,.55))}},["&.".concat(m.checked," + .").concat(m.track)]:{backgroundColor:(t.vars||t).palette[a].main}}}})]}}),f=(0,u.Ay)("span",{name:"MuiSwitch",slot:"Track",overridesResolver:(e,t)=>t.track})(e=>{let{theme:t}=e;return{height:"100%",width:"100%",borderRadius:7,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:"".concat("light"===t.palette.mode?t.palette.common.black:t.palette.common.white),opacity:t.vars?t.vars.opacity.switchTrack:"".concat("light"===t.palette.mode?.38:.3)}}),b=(0,u.Ay)("span",{name:"MuiSwitch",slot:"Thumb",overridesResolver:(e,t)=>t.thumb})(e=>{let{theme:t}=e;return{boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}}),w=r.forwardRef(function(e,t){const a=(0,h.b)({props:e,name:"MuiSwitch"}),{className:r,color:s="primary",edge:d=!1,size:u="medium",sx:v}=a,A=(0,n.A)(a,g),m=(0,l.A)({},a,{color:s,edge:d,size:u}),w=(e=>{const{classes:t,edge:a,size:n,color:r,checked:o,disabled:s}=e,d={root:["root",a&&"edge".concat((0,c.A)(a)),"size".concat((0,c.A)(n))],switchBase:["switchBase","color".concat((0,c.A)(r)),o&&"checked",s&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},u=(0,i.A)(d,p,t);return(0,l.A)({},t,u)})(m),C=(0,x.jsx)(b,{className:w.thumb,ownerState:m});return(0,x.jsxs)(y,{className:(0,o.A)(w.root,r),sx:v,ownerState:m,children:[(0,x.jsx)(j,(0,l.A)({type:"checkbox",icon:C,checkedIcon:C,ref:t,ownerState:m},A,{classes:(0,l.A)({},w,{root:w.switchBase})})),(0,x.jsx)(f,{className:w.track,ownerState:m})]})})},4421(e,t,a){a.r(t),a.d(t,{capitalize:()=>l.A,createChainedFunction:()=>r,createSvgIcon:()=>o.A,debounce:()=>i.A,deprecatedPropType:()=>s,isMuiElement:()=>c.A,ownerDocument:()=>d.A,ownerWindow:()=>u.A,requirePropFactory:()=>h,setRef:()=>v,unstable_ClassNameGenerator:()=>f,unstable_useEnhancedEffect:()=>A.A,unstable_useId:()=>p.A,unsupportedProp:()=>m,useControlled:()=>x.A,useEventCallback:()=>g.A,useForkRef:()=>y.A,useIsFocusVisible:()=>j.A});var n=a(9386),l=a(6803);const r=a(2456).A;var o=a(9662),i=a(950);const s=function(e,t){return()=>null};var c=a(7328),d=a(2427),u=a(6078);const h=function(e,t){return()=>null};const v=a(6564).A;var A=a(5013),p=a(5879);const m=function(e,t,a,n,l){return null};var x=a(4516),g=a(3319),y=a(5849),j=a(3574);const f={configure:e=>{n.A.configure(e)}}},5879(e,t,a){a.d(t,{A:()=>n});const n=a(5844).A}}]);
//# sourceMappingURL=678.9e628472.chunk.js.map