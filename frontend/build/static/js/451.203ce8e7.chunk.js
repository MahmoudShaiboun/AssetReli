"use strict";(self.webpackChunkaastreli_frontend=self.webpackChunkaastreli_frontend||[]).push([[451],{2451(e,s,n){n.r(s),n.d(s,{default:()=>M});var t=n(2555),r=n(5043),l=n(9252),o=n(1637),i=n(6446),a=n(5865),c=n(1906),d=n(547),u=n(9650),h=n(3336),A=n(1806),x=n(4882),p=n(8076),j=n(39),m=n(3460),v=n(3845),f=n(35),g=n(6600),y=n(5316),b=n(5795),_=n(3193),C=n(9190),S=n(9285),T=n(2143),q=n(9347),I=n(2505),w=n(5054),W=n(6624),k=n(579);const F={sensor_id:"",name:"",type:"pump",location:"",mqtt_topic:""};function M(){const{tenantVersion:e}=(0,W.n8)(),[s,n]=(0,r.useState)([]),[M,P]=(0,r.useState)(!0),[N,z]=(0,r.useState)(null),[D,E]=(0,r.useState)(null),[R,L]=(0,r.useState)(!1),[O,Q]=(0,r.useState)(!1),[V,B]=(0,r.useState)(F),G=async()=>{try{const e=await(0,w.w_)();n(e.sensors||[])}catch(e){console.error("Failed to load sensors:",e)}finally{P(!1)}};(0,r.useEffect)(()=>{G();const e=setInterval(G,1e4);return()=>clearInterval(e)},[e]);return M?(0,k.jsx)(l.A,{maxWidth:"lg",sx:{mt:4,display:"flex",justifyContent:"center"},children:(0,k.jsx)(o.A,{})}):(0,k.jsxs)(l.A,{maxWidth:"lg",sx:{mt:4,mb:4},children:[(0,k.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,k.jsx)(a.A,{variant:"h4",children:"Sensors"}),(0,k.jsx)(c.A,{variant:"contained",startIcon:(0,k.jsx)(I.A,{}),onClick:()=>L(!0),children:"Add Sensor"})]}),D&&(0,k.jsx)(d.A,{severity:"success",sx:{mb:2},onClose:()=>E(null),children:D}),N&&!R&&(0,k.jsx)(d.A,{severity:"error",sx:{mb:2},onClose:()=>z(null),children:N}),(0,k.jsx)(u.A,{component:h.A,children:(0,k.jsxs)(A.A,{children:[(0,k.jsx)(x.A,{children:(0,k.jsxs)(p.A,{children:[(0,k.jsx)(j.A,{children:(0,k.jsx)("strong",{children:"Sensor ID"})}),(0,k.jsx)(j.A,{children:(0,k.jsx)("strong",{children:"Name"})}),(0,k.jsx)(j.A,{children:(0,k.jsx)("strong",{children:"Type"})}),(0,k.jsx)(j.A,{children:(0,k.jsx)("strong",{children:"Location"})}),(0,k.jsx)(j.A,{children:(0,k.jsx)("strong",{children:"MQTT Topic"})}),(0,k.jsx)(j.A,{children:(0,k.jsx)("strong",{children:"Status"})})]})}),(0,k.jsx)(m.A,{children:0===s.length?(0,k.jsx)(p.A,{children:(0,k.jsx)(j.A,{colSpan:6,align:"center",children:(0,k.jsx)(a.A,{variant:"body2",color:"text.secondary",sx:{py:4},children:'No sensors registered. Click "Add Sensor" to get started.'})})}):s.map(e=>(0,k.jsxs)(p.A,{hover:!0,children:[(0,k.jsx)(j.A,{children:(0,k.jsx)(a.A,{variant:"body2",sx:{fontFamily:"monospace",fontWeight:600},children:e.sensor_id})}),(0,k.jsx)(j.A,{children:e.name}),(0,k.jsx)(j.A,{children:(0,k.jsx)(v.A,{label:e.type,size:"small",variant:"outlined"})}),(0,k.jsx)(j.A,{children:e.location||"\u2014"}),(0,k.jsx)(j.A,{children:(0,k.jsx)(v.A,{label:e.mqtt_topic||"sensors/".concat(e.sensor_id),size:"small",sx:{fontFamily:"monospace"}})}),(0,k.jsx)(j.A,{children:(0,k.jsx)(v.A,{label:e.status||"active",size:"small",color:"active"!==e.status&&e.status?"default":"success"})})]},e._id))})]})}),(0,k.jsxs)(f.A,{open:R,onClose:()=>L(!1),maxWidth:"sm",fullWidth:!0,children:[(0,k.jsx)(g.A,{children:"Register New Sensor"}),(0,k.jsxs)(y.A,{children:[N&&R&&(0,k.jsx)(d.A,{severity:"error",sx:{mb:2,mt:1},onClose:()=>z(null),children:N}),(0,k.jsx)(b.A,{fullWidth:!0,required:!0,label:"Sensor ID",value:V.sensor_id,onChange:e=>B((0,t.A)((0,t.A)({},V),{},{sensor_id:e.target.value})),sx:{mt:2,mb:2},placeholder:"e.g. pump_02",helperText:V.sensor_id?"MQTT topic: sensors/".concat(V.sensor_id):"Unique identifier for this sensor"}),(0,k.jsx)(b.A,{fullWidth:!0,required:!0,label:"Name",value:V.name,onChange:e=>B((0,t.A)((0,t.A)({},V),{},{name:e.target.value})),sx:{mb:2},placeholder:"e.g. Main Pump 2"}),(0,k.jsxs)(_.A,{fullWidth:!0,sx:{mb:2},children:[(0,k.jsx)(C.A,{children:"Type"}),(0,k.jsxs)(S.A,{value:V.type,label:"Type",onChange:e=>B((0,t.A)((0,t.A)({},V),{},{type:e.target.value})),children:[(0,k.jsx)(T.A,{value:"pump",children:"Pump"}),(0,k.jsx)(T.A,{value:"motor",children:"Motor"}),(0,k.jsx)(T.A,{value:"compressor",children:"Compressor"}),(0,k.jsx)(T.A,{value:"other",children:"Other"})]})]}),(0,k.jsx)(b.A,{fullWidth:!0,label:"Location",value:V.location,onChange:e=>B((0,t.A)((0,t.A)({},V),{},{location:e.target.value})),sx:{mb:2},placeholder:"e.g. Building A"}),(0,k.jsx)(b.A,{fullWidth:!0,label:"MQTT Topic (optional)",value:V.mqtt_topic,onChange:e=>B((0,t.A)((0,t.A)({},V),{},{mqtt_topic:e.target.value})),placeholder:V.sensor_id?"sensors/".concat(V.sensor_id):"sensors/{sensor_id}",helperText:"Leave empty to auto-derive from Sensor ID"})]}),(0,k.jsxs)(q.A,{sx:{px:3,pb:2},children:[(0,k.jsx)(c.A,{onClick:()=>{L(!1),z(null)},children:"Cancel"}),(0,k.jsx)(c.A,{variant:"contained",onClick:async()=>{if(V.sensor_id&&V.name&&V.type){Q(!0),z(null);try{const e={sensor_id:V.sensor_id,name:V.name,type:V.type};V.location&&(e.location=V.location),V.mqtt_topic&&(e.mqtt_topic=V.mqtt_topic),await(0,w.nc)(e),E('Sensor "'.concat(V.sensor_id,'" registered successfully')),setTimeout(()=>E(null),4e3),L(!1),B(F),await G()}catch(n){var e,s;z((null===(e=n.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Failed to register sensor")}finally{Q(!1)}}else z("Sensor ID, Name, and Type are required")},disabled:O||!V.sensor_id||!V.name,children:O?"Registering...":"Register Sensor"})]})]})]})}},2505(e,s,n){var t=n(4994);s.A=void 0;var r=t(n(2420)),l=n(579);s.A=(0,r.default)((0,l.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add")},2420(e,s,n){Object.defineProperty(s,"__esModule",{value:!0}),Object.defineProperty(s,"default",{enumerable:!0,get:function(){return t.createSvgIcon}});var t=n(4421)},4421(e,s,n){n.r(s),n.d(s,{capitalize:()=>r.A,createChainedFunction:()=>l,createSvgIcon:()=>o.A,debounce:()=>i.A,deprecatedPropType:()=>a,isMuiElement:()=>c.A,ownerDocument:()=>d.A,ownerWindow:()=>u.A,requirePropFactory:()=>h,setRef:()=>A,unstable_ClassNameGenerator:()=>y,unstable_useEnhancedEffect:()=>x.A,unstable_useId:()=>p.A,unsupportedProp:()=>j,useControlled:()=>m.A,useEventCallback:()=>v.A,useForkRef:()=>f.A,useIsFocusVisible:()=>g.A});var t=n(9386),r=n(6803);const l=n(2456).A;var o=n(9662),i=n(950);const a=function(e,s){return()=>null};var c=n(7328),d=n(2427),u=n(6078);const h=function(e,s){return()=>null};const A=n(6564).A;var x=n(5013),p=n(5879);const j=function(e,s,n,t,r){return null};var m=n(4516),v=n(3319),f=n(5849),g=n(3574);const y={configure:e=>{t.A.configure(e)}}},5879(e,s,n){n.d(s,{A:()=>t});const t=n(5844).A}}]);
//# sourceMappingURL=451.203ce8e7.chunk.js.map